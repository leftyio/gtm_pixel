﻿___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Lefty Conversion Pixel",
  "categories": [
    "AFFILIATE_MARKETING",
    "CONVERSIONS"
  ],
  "brand": {
    "id": "brand_dummy",
    "displayName": "Lefty",
    "thumbnail": "data:image/png;base64,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AEgA4SECCCCAAAIaBAgAGmaZMSKAAAIIIJAgQABIAOEhAggggAACGgQIABpmmTEigAACCCCQIEAASADhIQIIIIAAAhoECAAaZpkxIoAAAgggkCBAAEgA4SECCCCAAAIaBAgAGmaZMSKAAAIIIJAgQABIAOEhAggggAACGgQIABpmmTEigAACCCCQIEAASADhIQIIIIAAAhoECAAaZpkxIoAAAgggkCBAAEgA4SECCCCAAAIaBAgAGmaZMSKAAAIIIJAgQABIAOEhAggggAACGgQIABpmmTEigAACCCCQIEAASADhIQIIIIAAAhoECAAaZpkxIoAAAgggkCBAAEgA4SECCCCAAAIaBAgAGmaZMSKAAAIIIJAgQABIAOEhAggggAACGgQIABpmmTEigAACCCCQIEAASADhIQIIIIAAAhoECAAaZpkxIoAAAgggkCBAAEgA4SECCCCAAAIaBAgAGmaZMSKAAAIIIJAgQABIAOEhAggggAACGgQIABpmmTEigAACCCCQIEAASADhIQIIIIAAAhoECAAaZpkxIoAAAgggkCBAAEgA4SECCCCAAAIaBAgAGmaZMSKAAAIIIJAgQABIAOEhAggggAACGgQIABpmmTEigAACCCCQIEAASADhIQIIIIAAAhoE/h8ZHV0Ps2h1ywAAAABJRU5ErkJggg\u003d\u003d"
  },
  "description": "Setup affiliation conversion tracking for Lefty",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Enter your template code here.
const log = require('logToConsole');
const sendPixel = require('sendPixel');
const encodeUri = require('encodeUri');
const copyFromDataLayer = require('copyFromDataLayer');
const getReferrerUrl = require('getReferrerUrl');
const queryPermission = require('queryPermission');

const conversionKey = 'lefty.conversion';
if (queryPermission('read_data_layer', conversionKey)) {
  log('read_data_layer permission OK!');
  const leftyConversion = copyFromDataLayer(conversionKey) || {};
  const products = leftyConversion.products;
  
  if (!products || products.length === 0) {
     log("Products list not found");
     data.gtmOnFailure();
     return;
  }
 
  if (!leftyConversion.orderId) {
     log("Order ID not found");
     data.gtmOnFailure();
     return;
  }
  
  if (!leftyConversion.amount) {
     log("Order amount not found");
     data.gtmOnFailure();
     return;
  }
  
  if (!leftyConversion.currencyCode) {
     log("Order currency not found");
     data.gtmOnFailure();
     return;
  }
 

  /// could be GTM javascript variable
  const pIds = products.map((item) => 'pId=' + item.id).join('&');  
  const pNames = products.map((item) =>'pName=' + item.name).join('&'); 
  const itemQty = products.map((item) => 'itemQty=' + item.quantity).join('&');  
  const itemAmount = products.map((item) => 'itemAmount=' + item.amount).join('&');
  
  let uri = 'type=conversion';
  uri += '&orderId=' + leftyConversion.orderId;
  uri += '&amount=' + leftyConversion.amount;
  uri += '&currency=' + leftyConversion.currencyCode;
  uri += '&' + pIds;
  uri += '&' + pNames;
  uri += '&' + itemQty;
  uri += '&' + itemAmount; 
  
  uri += '&ref=' + getReferrerUrl('host');
  
  let url = 'https://a.lefty.io/track?' + encodeUri(uri);

  sendPixel(url, data.gtmOnSuccess, data.gtmOnFailure);
} else {
   log('read_data_layer permission KO!');
   data.gtmOnFailure();
}


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_pixel",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://a.lefty.io/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_data_layer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keyPatterns",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "lefty.*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_referrer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Trigger send pixel for 1 product
  code: |-
    mock("copyFromDataLayer", {
      products: [
        {
          id: '1',
          name: 'Test 1',
          quantity: 1,
          amount: 12
        }
      ],
      orderId: 1,
      currencyCode: 'USD',
      amount: 12
    });

    mock('sendPixel', function(url, onSuccess, onFailure) {
        assertThat(url).isEqualTo("https://a.lefty.io/track?type=conversion&orderId=1&amount=12&currency=USD&pId=1&pName=Test%201&itemQty=1&itemAmount=12&ref=https://test.com");
        onSuccess();
    });

    runCode({});

    assertApi('sendPixel').wasCalled();
    assertApi('gtmOnSuccess').wasCalled();
- name: Trigger send pixel for multiple products
  code: "mock(\"copyFromDataLayer\", {\n  products: [\n    {\n      id: '1',\n   \
    \   name: 'Test 1',\n      quantity: 1,\n      amount: 10\n    },\n    {\n   \
    \   id: '2',\n      name: 'Test 2',\n      quantity: 2,\n      amount: 30\n  \
    \  },\n    {\n      id: '3',\n      name: 'Test 3',\n      quantity: 1,\n    \
    \  amount: 5\n    }\n  ],\n  orderId: 1,\n  currencyCode: 'USD',\n  amount: 45\n\
    });\n\nmock('sendPixel', function(url, onSuccess, onFailure) {\n    assertThat(url).isEqualTo(\"\
    https://a.lefty.io/track?type=conversion&orderId=1&amount=45&currency=USD&pId=1&pId=2&pId=3&pName=Test%201&pName=Test%202&pName=Test%203&itemQty=1&itemQty=2&itemQty=1&itemAmount=10&itemAmount=30&itemAmount=5&ref=https://test.com\"\
    );\n  \n  onSuccess();\n});\n\nrunCode({});\n\nassertApi('sendPixel').wasCalled();\n\
    assertApi('gtmOnSuccess').wasCalled();"
- name: Products list not found cause failure
  code: |-
    mock("copyFromDataLayer", {
      products: []
    });

    runCode({});


    assertApi('gtmOnFailure').wasCalled();
- name: Products list empty cause failure
  code: |-
    mock("copyFromDataLayer", {});

    runCode({});

    assertApi('gtmOnFailure').wasCalled();
- name: Order ID not found
  code: |-
    mock("copyFromDataLayer", {
      products: [
        {
          id: '1',
          name: 'Test 1',
          quantity: 1,
          amount: 12
        }
      ],
      currencyCode: 'USD',
      amount: 12
    });


    runCode({});

    assertApi('gtmOnFailure').wasCalled();
- name: Order currency not found
  code: |-
    mock("copyFromDataLayer", {
      products: [
        {
          id: '1',
          name: 'Test 1',
          quantity: 1,
          amount: 12
        }
      ],
      orderId: '1',
      amount: 12
    });


    runCode({});

    assertApi('gtmOnFailure').wasCalled();
- name: Order amount not found
  code: |-
    mock("copyFromDataLayer", {
      products: [
        {
          id: '1',
          name: 'Test 1',
          quantity: 1,
          amount: 12
        }
      ],
      orderId: '1',
      currencyCode: 'USD',
    });


    runCode({});

    assertApi('gtmOnFailure').wasCalled();
setup: mock('getReferrerUrl', "https://test.com");


___NOTES___

Created on 10/29/2021, 10:39:42 AM

